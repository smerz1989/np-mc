

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>molecule_class &mdash; NP Monolayer Monte Carlo 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> NP Monolayer Monte Carlo
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../inheritance.html">Plot of Module Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coverage.html">Undocumented Python objects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../coverage.html#atom-class">atom_class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simulation_class.html">Simulation Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../move_class.html">Move Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../molecule_class.html">Molecule Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atom_class.html">Atom Class</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NP Monolayer Monte Carlo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>molecule_class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for molecule_class</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;This module contains the molecule class and all classes and functions</span>
<span class="sd">related to molecules.  This includes Bond, Angle, and Dihedral classes as well as helper functions that take in atom and bond lists and generate molecules.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">npmc.read_lmp_rev6</span> <span class="k">as</span> <span class="nn">rdlmp</span>
<span class="kn">import</span> <span class="nn">npmc.atom_class</span> <span class="k">as</span> <span class="nn">atm</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">groupby</span><span class="p">,</span> <span class="n">permutations</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">ntwkx</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="o">*</span>

<div class="viewcode-block" id="Molecule"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Molecule">[docs]</a><span class="k">class</span> <span class="nc">Molecule</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is used to represent a molecule in a simulation and holds all</span>
<span class="sd">        the objects related to a molecule including the related Atom, Bond, Angle, and Dihedral Objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        molID : int</span>
<span class="sd">            The unique integer identifier of the molecule as set in the LAMMPS input file</span>
<span class="sd">        atoms : list of type Atom</span>
<span class="sd">            The Atom objects associated with this molecule</span>
<span class="sd">        bonds : list of type Bond</span>
<span class="sd">            The Bond objects associated with this molecule</span>
<span class="sd">        angles : list of type Angle</span>
<span class="sd">            The Angle objects associated with this molecule</span>
<span class="sd">        dihedrals : list of type Dihedral</span>
<span class="sd">            The Dihedral objects associated with this molecule</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">molID</span><span class="p">,</span><span class="n">atoms</span><span class="p">,</span><span class="n">bonds</span><span class="p">,</span><span class="n">angles</span><span class="p">,</span><span class="n">dihedrals</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molID</span> <span class="o">=</span> <span class="n">molID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span> <span class="o">=</span> <span class="n">bonds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="n">angles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dihedrals</span> <span class="o">=</span> <span class="n">dihedrals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomsAsGraph</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">==</span><span class="n">other</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds</span><span class="o">==</span><span class="n">other</span><span class="o">.</span><span class="n">bonds</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="o">==</span><span class="n">other</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dihedrals</span><span class="o">==</span><span class="n">other</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">def</span> <span class="nf">__neq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

<div class="viewcode-block" id="Molecule.get_com"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Molecule.get_com">[docs]</a>    <span class="k">def</span> <span class="nf">get_com</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the center of mass of the molecule.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        com : array of floats</span>
<span class="sd">            The center of mass of the molecule.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">atom</span><span class="o">.</span><span class="n">position</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">])</span>
        <span class="n">com</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">com</span><span class="p">)</span></div>

<div class="viewcode-block" id="Molecule.setAnchorAtom"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Molecule.setAnchorAtom">[docs]</a>    <span class="k">def</span> <span class="nf">setAnchorAtom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">atomID</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the anchor atom of the molecule this is the atom of the molecule that is anchored to the nanoparticle.  Setting this important when using the CBMC regrowth move.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atomID : int</span>
<span class="sd">            The unique atom ID identifier of the Atom object that is anchored to the nanoparticle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByID</span><span class="p">(</span><span class="n">atomID</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">atom</span><span class="o">!=</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">anchorAtom</span> <span class="o">=</span> <span class="n">atom</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>
    
<div class="viewcode-block" id="Molecule.atomsAsGraph"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Molecule.atomsAsGraph">[docs]</a>    <span class="k">def</span> <span class="nf">atomsAsGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the graph data structure of the atoms in the molecule defined by the connectivity defined by the Bond objects of the molecule.  </span>
<span class="sd">        The nodes of the graph are the atom ID&#39;s of the atoms.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Networkx Graph Object</span>
<span class="sd">            A Networkx Graph object with the nodes being the atom ID&#39;s of the atoms in the molecule and the connections defined by the Molecule&#39;s Bonds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">molecule2graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds</span><span class="p">)</span></div>
<div class="viewcode-block" id="Molecule.getAtomByID"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Molecule.getAtomByID">[docs]</a>    <span class="k">def</span> <span class="nf">getAtomByID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">atomID</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the Atom object associated with the given atom ID as long as the atom is associated with the molecule.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atomID : int</span>
<span class="sd">            The unique atom ID identifier of the Atom object which you hope to retrieve</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Atom</span>
<span class="sd">                The Atom object associated with the atom ID or None if the Atom is not associated with this molecule.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="k">if</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">atomID</span><span class="o">==</span><span class="n">atomID</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">atom</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Molecule.getAtomByMolIndex"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Molecule.getAtomByMolIndex">[docs]</a>    <span class="k">def</span> <span class="nf">getAtomByMolIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the Atom by it&#39;s index in the molecule where the index is defined as the number of bonds away from the anchor atom </span>
<span class="sd">        (i.e. the atom at index 1 is the atom directly connected to the anchor atom)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : int</span>
<span class="sd">            The molecular index of the Atom object one wishes to retrieve where the index is defined as the number of bonds away from the anchor atom.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Atom Object</span>
<span class="sd">            The Atom Object located at the specified index if the index is greater than the number of atoms in the molecule minus one then </span>
<span class="sd">            the function returns None as this is out of the range of the atom list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">index</span><span class="o">&gt;</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">successor_dict</span><span class="o">=</span> <span class="n">ntwkx</span><span class="o">.</span><span class="n">dfs_successors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anchorAtom</span><span class="o">.</span><span class="n">atomID</span><span class="p">)</span>
        <span class="n">currentID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchorAtom</span><span class="o">.</span><span class="n">atomID</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
            <span class="n">currentID</span> <span class="o">=</span> <span class="n">successor_dict</span><span class="p">[</span><span class="n">currentID</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByID</span><span class="p">(</span><span class="n">currentID</span><span class="p">)</span></div>

<div class="viewcode-block" id="Molecule.rotateDihedral"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Molecule.rotateDihedral">[docs]</a>    <span class="k">def</span> <span class="nf">rotateDihedral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">theta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rotates the atoms of the molecule from the atom given by &#39;index&#39; all the way to the last atom (here the last atom is the one opposite the defined &quot;anchor atom&quot;) about a dihedral axis.</span>
<span class="sd">        Here the dihedral axis is defined by the two atoms that come before the &#39;index&#39; atom as defined by the graph of the molecule.  Due to the way the function is defined the &#39;index&#39; of the </span>
<span class="sd">        atom must be greater than 3, but of course less than the total length of the molecule.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : int</span>
<span class="sd">            The index of the atom which is the starting atom of the rotation and consequently the last atom of the dihedral of whose axis you wish to rotate the molecule about.</span>
<span class="sd">        theta : float</span>
<span class="sd">            The angle in radians which specifies the angle of rotation about the dihedral axis which you want to perform.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">index</span><span class="o">&lt;</span><span class="mi">3</span> <span class="ow">or</span> <span class="n">index</span><span class="o">&gt;</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;In order to rotate dihedral you must pass an 3&lt;=index&lt;=len(atoms)-1, you passed </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">index</span><span class="p">)</span>
        <span class="n">atom2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByMolIndex</span><span class="p">(</span><span class="n">index</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">atom3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByMolIndex</span><span class="p">(</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">atom3</span><span class="o">.</span><span class="n">position</span><span class="o">-</span><span class="n">atom2</span><span class="o">.</span><span class="n">position</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)):</span>
            <span class="n">atom4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByMolIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="n">atom4</span><span class="o">.</span><span class="n">position</span><span class="o">-</span><span class="n">atom3</span><span class="o">.</span><span class="n">position</span>
            <span class="n">atom4</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">rot_quat</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">axis</span><span class="p">)</span><span class="o">+</span><span class="n">atom3</span><span class="o">.</span><span class="n">position</span></div>

    
<div class="viewcode-block" id="Molecule.index2dihedral"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Molecule.index2dihedral">[docs]</a>    <span class="k">def</span> <span class="nf">index2dihedral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the dihedral associated with the given atom index of the molecule.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">        index : int</span>
<span class="sd">            The index of the molecule that one wants the associated dihedral.  Here the associated dihedral is the dihedral where the atom is the fourth atom of the dihedral.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dihedral : Dihedral</span>
<span class="sd">            The dihedral associated with the given index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">index</span><span class="o">&lt;</span><span class="mi">3</span> <span class="ow">or</span> <span class="n">index</span><span class="o">&gt;</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must pass the index of the fourth atom, which means the index must br greater than 2 and less than the length of the molecule.  The index you passed </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">index</span><span class="p">)</span>
        <span class="n">atom1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByMolIndex</span><span class="p">(</span><span class="n">index</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">atom2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByMolIndex</span><span class="p">(</span><span class="n">index</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">atom3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByMolIndex</span><span class="p">(</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">atom4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByMolIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">dihedral</span> <span class="o">=</span> <span class="p">[</span><span class="n">dihedral</span> <span class="k">for</span> <span class="n">dihedral</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dihedrals</span> <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom1</span><span class="o">==</span><span class="n">atom1</span><span class="o">.</span><span class="n">atomID</span><span class="p">,</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom2</span><span class="o">==</span><span class="n">atom2</span><span class="o">.</span><span class="n">atomID</span><span class="p">,</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom3</span><span class="o">==</span><span class="n">atom3</span><span class="o">.</span><span class="n">atomID</span><span class="p">,</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom4</span><span class="o">==</span><span class="n">atom4</span><span class="o">.</span><span class="n">atomID</span><span class="p">])][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span><span class="p">(</span><span class="n">dihedral</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Molecule.getDihedralAngle"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Molecule.getDihedralAngle">[docs]</a>    <span class="k">def</span> <span class="nf">getDihedralAngle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dihedral</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the dihedral angle of a given dihedral.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dihedral : Dihedral </span>
<span class="sd">            Dihedral Object that one wishes to calculate the dihedral angle of.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The current dihedral angle of the Dihedral object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atom1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByID</span><span class="p">(</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom1</span><span class="p">)</span>
        <span class="n">atom2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByID</span><span class="p">(</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom2</span><span class="p">)</span>
        <span class="n">atom3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByID</span><span class="p">(</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom3</span><span class="p">)</span>
        <span class="n">atom4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByID</span><span class="p">(</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom4</span><span class="p">)</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">atom2</span><span class="o">.</span><span class="n">position</span><span class="o">-</span><span class="n">atom1</span><span class="o">.</span><span class="n">position</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">atom3</span><span class="o">.</span><span class="n">position</span><span class="o">-</span><span class="n">atom2</span><span class="o">.</span><span class="n">position</span>
        <span class="n">b3</span> <span class="o">=</span> <span class="n">atom4</span><span class="o">.</span><span class="n">position</span><span class="o">-</span><span class="n">atom3</span><span class="o">.</span><span class="n">position</span>
        <span class="n">b2norm</span> <span class="o">=</span> <span class="n">b2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">))</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span><span class="n">b3</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span><span class="n">b3</span><span class="p">))</span>
        <span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="n">b2norm</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">))</span>    
        <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="o">%</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">angle</span></div>

    <span class="k">def</span> <span class="nf">align_to_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">vector</span><span class="p">):</span>
        <span class="n">molecule_vector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_com</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">anchorAtom</span><span class="o">.</span><span class="n">position</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span><span class="o">==</span><span class="mf">0.</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">molecule_vector</span><span class="p">)</span><span class="o">==</span><span class="mf">0.</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Alignment vector passed in must have a non-zero magnitude.&quot;</span><span class="p">)</span>
        <span class="n">anchor_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anchorAtom</span><span class="o">.</span><span class="n">position</span>
        <span class="n">axis_rotation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">molecule_vector</span><span class="p">,</span><span class="n">vector</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">acos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">molecule_vector</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">molecule_vector</span><span class="p">),</span><span class="n">vector</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vector</span><span class="p">)))</span>
        <span class="n">rotate_atoms</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">atomID</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">anchorAtom</span><span class="o">.</span><span class="n">atomID</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">rotate_atoms</span><span class="p">:</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">rot_quat</span><span class="p">((</span><span class="n">atom</span><span class="o">.</span><span class="n">position</span><span class="o">-</span><span class="n">anchor_position</span><span class="p">),</span><span class="n">angle</span><span class="p">,</span><span class="n">axis_rotation</span><span class="p">)</span><span class="o">+</span><span class="n">anchor_position</span>
        

    <span class="k">def</span> <span class="nf">move_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">move</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">position</span><span class="o">+=</span><span class="n">move</span>

    <span class="k">def</span> <span class="nf">move_atoms_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">move</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getAtomByMolIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">position</span><span class="o">+=</span><span class="n">move</span></div>

<div class="viewcode-block" id="Bond"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Bond">[docs]</a><span class="k">class</span> <span class="nc">Bond</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The Bond object represents a bond between two atoms. The format is similar to a LAMMPS bond, therefore a </span>
<span class="sd">    Bond object consists of a Bond ID which uniquely defines the bond, a bond type, and the atom ID&#39;s of the two atoms involved in the bond.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bondID : int</span>
<span class="sd">        The unique integer identifying the bonds same as the one defined in the LAMMPS input file</span>
<span class="sd">    bondType : int</span>
<span class="sd">        An integer which represents the type of bond this is, the same as the bond type number defined in LAMMPS input file.</span>
<span class="sd">    atom1 : int</span>
<span class="sd">        The atom ID associated with the first atom in the bond</span>
<span class="sd">    atom2 : int</span>
<span class="sd">        The atom ID associated with the second atom in the bond</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bondID</span><span class="p">,</span><span class="n">bondType</span><span class="p">,</span><span class="n">atom1</span><span class="p">,</span><span class="n">atom2</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bondID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bondID</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bondType</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bondType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">atom1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">atom2</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bondID</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">bondID</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">def</span> <span class="nf">__neq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="Angle"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Angle">[docs]</a><span class="k">class</span> <span class="nc">Angle</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The Angle object represents the angle between three connected atoms.  The format is the same as in the Angles section of a LAMMPS input file.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angleID : int</span>
<span class="sd">        The unique integer identifier of the angle, the same as the one defined in the LAMMPS inpit file</span>
<span class="sd">    angleType : int</span>
<span class="sd">        The integer identifier of the angle type which is the same as the angle type number defined in the LAMMPS input file</span>
<span class="sd">    atom1 : int</span>
<span class="sd">        The atom ID of the first atom associated with the angle, same as the one defined in LAMMPS input file.</span>
<span class="sd">    atom2 : int</span>
<span class="sd">        The atom ID of the second atom associated with the angle, same as the one defined in LAMMPS input file.</span>
<span class="sd">    atom3 : int</span>
<span class="sd">        The atom ID of the third atom associated with the angle, same as the one defined in LAMMPS input file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angleID</span><span class="p">,</span><span class="n">angleType</span><span class="p">,</span><span class="n">atom1</span><span class="p">,</span><span class="n">atom2</span><span class="p">,</span><span class="n">atom3</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angleID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">angleID</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angleType</span> <span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">angleType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">atom1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">atom2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">atom3</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">angleID</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">angleID</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">def</span> <span class="nf">__neq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="Dihedral"><a class="viewcode-back" href="../molecule_class.html#molecule_class.Dihedral">[docs]</a><span class="k">class</span> <span class="nc">Dihedral</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The Dihedral object represents the dihedral between four connected atoms.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dihID : int</span>
<span class="sd">        The unique integer identifier for the dihedral same as the one in the LAMMPS input file.</span>
<span class="sd">    dihType : int</span>
<span class="sd">        The unique integer identifier for the dihedral type which corresponds to the dihedral type in the LAMMPS input file.</span>
<span class="sd">    atom1 : int</span>
<span class="sd">        The atom ID of the first atom in the dihedral.</span>
<span class="sd">    atom2 : int</span>
<span class="sd">        The atom ID of the second atom in the dihedral.</span>
<span class="sd">    atom3 : int</span>
<span class="sd">        The atom ID of the third atom in the dihedral.</span>
<span class="sd">    atom4 : int</span>
<span class="sd">        The atom ID of the fourth atom in the dihedral.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dihID</span><span class="p">,</span><span class="n">dihType</span><span class="p">,</span><span class="n">atom1</span><span class="p">,</span><span class="n">atom2</span><span class="p">,</span><span class="n">atom3</span><span class="p">,</span><span class="n">atom4</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dihID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dihID</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dihType</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dihType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">atom1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">atom2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">atom3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">atom4</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">dihID</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dihID</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">def</span> <span class="nf">__neq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></div>


<div class="viewcode-block" id="loadBonds"><a class="viewcode-back" href="../molecule_class.html#molecule_class.loadBonds">[docs]</a><span class="k">def</span> <span class="nf">loadBonds</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function loads the Bonds from a LAMMPS input file and turns them into a list of Bond objects.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The filename of the LAMMPS input file which has the Bonds you wish to use.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Bond List</span>
<span class="sd">        A list of Bond objects with the same value as the Bonds in the LAMMPS input file passed in.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bonds</span> <span class="o">=</span> <span class="n">rdlmp</span><span class="o">.</span><span class="n">readBonds</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Bond</span><span class="p">(</span><span class="n">bond</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">bond</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">bond</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">bond</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">bonds</span><span class="p">]</span></div>

<div class="viewcode-block" id="loadAngles"><a class="viewcode-back" href="../molecule_class.html#molecule_class.loadAngles">[docs]</a><span class="k">def</span> <span class="nf">loadAngles</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function loads the Angless from a LAMMPS input file and turns them into a list of Angle objects.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The filename of the LAMMPS input file which has the Angles you wish to use.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Angle List</span>
<span class="sd">        A list of Angle objects with the same value as the Angles in the LAMMPS input file passed in.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">rdlmp</span><span class="o">.</span><span class="n">readAngles</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Angle</span><span class="p">(</span><span class="n">angle</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">angle</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">angle</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">angle</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">angle</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">]</span></div>

<div class="viewcode-block" id="loadDihedrals"><a class="viewcode-back" href="../molecule_class.html#molecule_class.loadDihedrals">[docs]</a><span class="k">def</span> <span class="nf">loadDihedrals</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function loads the Dihedrals from a LAMMPS input file and turns them into a list of Dihedral objects.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The filename of the LAMMPS input file which has the Dihedrals you wish to use.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Dihedral List</span>
<span class="sd">        A list of Dihedral objects with the same value as the Dihedrals in the LAMMPS input file passed in.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dihedrals</span> <span class="o">=</span> <span class="n">rdlmp</span><span class="o">.</span><span class="n">readDihedrals</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Dihedral</span><span class="p">(</span><span class="n">dihedral</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">dihedral</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">dihedral</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">dihedral</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">dihedral</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">dihedral</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="k">for</span> <span class="n">dihedral</span> <span class="ow">in</span> <span class="n">dihedrals</span><span class="p">]</span></div>

<div class="viewcode-block" id="getBondsFromAtoms"><a class="viewcode-back" href="../molecule_class.html#molecule_class.getBondsFromAtoms">[docs]</a><span class="k">def</span> <span class="nf">getBondsFromAtoms</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span><span class="n">bonds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Based on a list of atoms find all bonds in Bond list, bonds that contain these atoms.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    atoms : Atom List</span>
<span class="sd">        A list of Atom objects which are the basis for searching through the bond list.</span>
<span class="sd">    bonds : Bond List</span>
<span class="sd">        A List of Bond objects which the function searches through.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Bond List</span>
<span class="sd">        A list of all Bond objects that contain any of the given Atom objects atoms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_combos</span> <span class="o">=</span> <span class="p">[(</span><span class="n">atom1</span><span class="o">.</span><span class="n">atomID</span><span class="p">,</span><span class="n">atom2</span><span class="o">.</span><span class="n">atomID</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">atom1</span><span class="p">,</span><span class="n">atom2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">)]</span>
    <span class="n">bondlist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">bonds</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">bond</span><span class="o">.</span><span class="n">atom1</span><span class="p">,</span><span class="n">bond</span><span class="o">.</span><span class="n">atom2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">id_combos</span><span class="p">:</span>
            <span class="n">bondlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span>            
    <span class="k">return</span> <span class="n">bondlist</span></div>

<div class="viewcode-block" id="getAnglesFromAtoms"><a class="viewcode-back" href="../molecule_class.html#molecule_class.getAnglesFromAtoms">[docs]</a><span class="k">def</span> <span class="nf">getAnglesFromAtoms</span><span class="p">(</span><span class="n">atomlist</span><span class="p">,</span><span class="n">bondlist</span><span class="p">,</span><span class="n">angles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a list of Atoms find all the Angles in angles which contains these atoms.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    atomlist : Atom List</span>
<span class="sd">        A list of Atoms used to search through the Angle List.</span>
<span class="sd">    bondlist : Bond List</span>
<span class="sd">        A List of Bond objects used to get connectivity of atoms.  The connectivity is used to find the possible angle combinations of the Atoms in atoms.</span>
<span class="sd">    angles : Angle List</span>
<span class="sd">        A List of Angles which is searched through.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    anglelist : Angle List</span>
<span class="sd">        A list of Angles that are associated with the Atoms in atoms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol_graph</span> <span class="o">=</span> <span class="n">molecule2graph</span><span class="p">(</span><span class="n">atomlist</span><span class="p">,</span><span class="n">bondlist</span><span class="p">)</span>
    <span class="n">angle_combos</span><span class="o">=</span><span class="p">[]</span>
    <span class="c1">#Get possible angles by getting subgraphs with only 2 steps</span>
    <span class="k">for</span> <span class="n">atom1</span><span class="p">,</span><span class="n">atom2</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">mol_graph</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">(),</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ntwkx</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="n">mol_graph</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="n">atom1</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="n">atom2</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">angle_combos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ntwkx</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="n">mol_graph</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="n">atom1</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="n">atom2</span><span class="p">))</span>      
    <span class="n">anglelist</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">:</span>
        <span class="k">if</span><span class="p">([</span><span class="n">angle</span><span class="o">.</span><span class="n">atom1</span><span class="p">,</span><span class="n">angle</span><span class="o">.</span><span class="n">atom2</span><span class="p">,</span><span class="n">angle</span><span class="o">.</span><span class="n">atom3</span><span class="p">]</span> <span class="ow">in</span> <span class="n">angle_combos</span><span class="p">):</span>
            <span class="n">anglelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">anglelist</span></div>

<div class="viewcode-block" id="getDihedralsFromAtoms"><a class="viewcode-back" href="../molecule_class.html#molecule_class.getDihedralsFromAtoms">[docs]</a><span class="k">def</span> <span class="nf">getDihedralsFromAtoms</span><span class="p">(</span><span class="n">atomlist</span><span class="p">,</span><span class="n">bondlist</span><span class="p">,</span><span class="n">dihedrals</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a list of Atoms find all the Dihedral objects in dihedrals which contains these atoms.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    atomlist : Atom List</span>
<span class="sd">        A list of Atoms used to search through the Dihedral List.</span>
<span class="sd">    bondlist : Bond List</span>
<span class="sd">        A List of Bond objects used to get connectivity of atoms.  The connectivity is used to find the possible dihedral combinations of the Atoms in atoms.</span>
<span class="sd">    angles : Angle List</span>
<span class="sd">        A List of Angles which is searched through.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    anglelist : Angle List</span>
<span class="sd">        A list of Angles that are associated with the Atoms in atoms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol_graph</span> <span class="o">=</span> <span class="n">molecule2graph</span><span class="p">(</span><span class="n">atomlist</span><span class="p">,</span><span class="n">bondlist</span><span class="p">)</span>
    <span class="n">dihedral_combos</span><span class="o">=</span><span class="p">[]</span>
    <span class="c1">#Get possible angles by getting subgraphs with only 2 steps</span>
    <span class="k">for</span> <span class="n">atom1</span><span class="p">,</span><span class="n">atom2</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">mol_graph</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">(),</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ntwkx</span><span class="o">.</span><span class="n">shortest_path_length</span><span class="p">(</span><span class="n">mol_graph</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="n">atom1</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="n">atom2</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">dihedral_combos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ntwkx</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="n">mol_graph</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="n">atom1</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="n">atom2</span><span class="p">))</span>      
    <span class="n">dihedral_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">dihedral</span> <span class="ow">in</span> <span class="n">dihedrals</span><span class="p">:</span>
        <span class="k">if</span><span class="p">([</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom1</span><span class="p">,</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom2</span><span class="p">,</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom3</span><span class="p">,</span><span class="n">dihedral</span><span class="o">.</span><span class="n">atom4</span><span class="p">]</span> <span class="ow">in</span> <span class="n">dihedral_combos</span><span class="p">):</span>
            <span class="n">dihedral_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dihedral</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dihedral_list</span></div>

<div class="viewcode-block" id="groupAtomsByMol"><a class="viewcode-back" href="../molecule_class.html#molecule_class.groupAtomsByMol">[docs]</a><span class="k">def</span> <span class="nf">groupAtomsByMol</span><span class="p">(</span><span class="n">atoms</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Group atoms by their associated molecular ID</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    atoms : Atom List</span>
<span class="sd">        A list of Atom objects that you want grouped by molecule ID</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mol_dict : Atom List Dictionary</span>
<span class="sd">        A dictionary with the molecule ID&#39;s as keys and the list of atoms associated with that molecule ID as the entries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">g</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">get_mol_ID</span><span class="p">())):</span>
        <span class="n">mol_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mol_dict</span></div>

<div class="viewcode-block" id="groupBondsByMol"><a class="viewcode-back" href="../molecule_class.html#molecule_class.groupBondsByMol">[docs]</a><span class="k">def</span> <span class="nf">groupBondsByMol</span><span class="p">(</span><span class="n">mol_dict</span><span class="p">,</span><span class="n">bonds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Group bonds by their associated molecular ID</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mol_dict : Atom List Dictionary</span>
<span class="sd">        A dictionary of Atom List with each entry indexed by molecule ID and the entries with that index being an Atom list of Atom objects associated with the molecule ID</span>
<span class="sd">    bonds : Bond List</span>
<span class="sd">        A list of Bond objects that you want grouped by molecule ID</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bond_dict : Bond List Dictionary</span>
<span class="sd">        A dictionary with the molecule ID&#39;s as keys and the list of bonds associated with that molecule ID as the entries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bond_dict</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">molid</span> <span class="ow">in</span> <span class="n">mol_dict</span><span class="p">:</span> 
        <span class="n">bond_dict</span><span class="p">[</span><span class="n">molid</span><span class="p">]</span> <span class="o">=</span> <span class="n">getBondsFromAtoms</span><span class="p">(</span><span class="n">mol_dict</span><span class="p">[</span><span class="n">molid</span><span class="p">],</span><span class="n">bonds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bond_dict</span></div>

<div class="viewcode-block" id="groupAnglesByMol"><a class="viewcode-back" href="../molecule_class.html#molecule_class.groupAnglesByMol">[docs]</a><span class="k">def</span> <span class="nf">groupAnglesByMol</span><span class="p">(</span><span class="n">mol_dict</span><span class="p">,</span><span class="n">bond_dict</span><span class="p">,</span><span class="n">angles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Group angles by their associated molecular ID</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mol_dict : Atom List Dictionary</span>
<span class="sd">        A dictionary of Atom List with each entry indexed by molecule ID and the entries with that index being an Atom list of Atom objects associated with the molecule ID</span>
<span class="sd">    bond_dict : Bond List Dictionary</span>
<span class="sd">        A dictionary of Bond List items indexed by their associated molecule ID.</span>
<span class="sd">    angles : Angle List</span>
<span class="sd">        A list of Angle objects that you want grouped by molecule ID</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    angle_dict : Angle List Dictionary</span>
<span class="sd">        A dictionary with the molecule ID&#39;s as keys and the list of angles associated with that molecule ID as the entries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angle_dict</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">molid</span> <span class="ow">in</span> <span class="n">mol_dict</span><span class="p">:</span>
        <span class="n">angle_dict</span><span class="p">[</span><span class="n">molid</span><span class="p">]</span><span class="o">=</span><span class="n">getAnglesFromAtoms</span><span class="p">(</span><span class="n">mol_dict</span><span class="p">[</span><span class="n">molid</span><span class="p">],</span><span class="n">bond_dict</span><span class="p">[</span><span class="n">molid</span><span class="p">],</span><span class="n">angles</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">angle_dict</span></div>

<div class="viewcode-block" id="groupDihedralsByMol"><a class="viewcode-back" href="../molecule_class.html#molecule_class.groupDihedralsByMol">[docs]</a><span class="k">def</span> <span class="nf">groupDihedralsByMol</span><span class="p">(</span><span class="n">mol_dict</span><span class="p">,</span><span class="n">bond_dict</span><span class="p">,</span><span class="n">dihedrals</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Group dihedrals by theri associated molecule ID</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mol_dict : Atom List Dictionary</span>
<span class="sd">        A dictionary of Atom Lists indexed by their associated molecule ID&#39;s</span>
<span class="sd">    bond_dict : Bond List Dictionary</span>
<span class="sd">        A dictionary of Bond Lists indexed by their associated molecule ID&#39;s</span>
<span class="sd">    dihedrals : Dihedral List</span>
<span class="sd">        A list of dihedrals to by grouped by molecule ID.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dihedral_dict : Dihedral List Dictionary</span>
<span class="sd">        A dictionary of Dihedral Lists indexed by their associated molecule ID.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dihedral_dict</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">molID</span> <span class="ow">in</span> <span class="n">mol_dict</span><span class="p">:</span>
        <span class="n">dihedral_dict</span><span class="p">[</span><span class="n">molID</span><span class="p">]</span><span class="o">=</span><span class="n">getDihedralsFromAtoms</span><span class="p">(</span><span class="n">mol_dict</span><span class="p">[</span><span class="n">molID</span><span class="p">],</span><span class="n">bond_dict</span><span class="p">[</span><span class="n">molID</span><span class="p">],</span><span class="n">dihedrals</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dihedral_dict</span></div>

<div class="viewcode-block" id="set_anchor_atoms"><a class="viewcode-back" href="../molecule_class.html#molecule_class.set_anchor_atoms">[docs]</a><span class="k">def</span> <span class="nf">set_anchor_atoms</span><span class="p">(</span><span class="n">molecules</span><span class="p">,</span><span class="n">anchortype</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For every molecule in molecules set the anchot atom to the atom with atom type anchortype.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    molecules : list of Molecule</span>
<span class="sd">    A list of Molecule objects that will have their anchor atoms set to the atom with type anchortype.</span>
<span class="sd">    anchortype : int</span>
<span class="sd">    The atom type of the atom to set as the anchor for each Molecule in molecules.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">molecules</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">anchorIDs</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">atomID</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">atomType</span><span class="o">==</span><span class="n">anchortype</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">anchorIDs</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">molecule</span><span class="o">.</span><span class="n">setAnchorAtom</span><span class="p">(</span><span class="n">anchorIDs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="molecule2graph"><a class="viewcode-back" href="../molecule_class.html#molecule_class.molecule2graph">[docs]</a><span class="k">def</span> <span class="nf">molecule2graph</span><span class="p">(</span><span class="n">atomlist</span><span class="p">,</span><span class="n">bondlist</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts the Atom list and Bond list of a molecule to a graph data object</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    atomlist : Atom List</span>
<span class="sd">        A list of atoms in the molecule</span>
<span class="sd">    bondlist : Bond List</span>
<span class="sd">        A list of bonds associated with the molecule</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    molecule_graph : Networkx Graph</span>
<span class="sd">        A Networkx Graph object with the nodes being the atom ID&#39;s of the atoms and the connectivity of the graph defined by the bonds in the bondlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">molecule_graph</span> <span class="o">=</span> <span class="n">ntwkx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atomlist</span><span class="p">:</span>
        <span class="n">molecule_graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">atomID</span><span class="p">)</span>
    <span class="n">molecule_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="n">bond</span><span class="o">.</span><span class="n">atom1</span><span class="p">,</span><span class="n">bond</span><span class="o">.</span><span class="n">atom2</span><span class="p">)</span> <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">bondlist</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">molecule_graph</span></div>

<div class="viewcode-block" id="constructMolecules"><a class="viewcode-back" href="../molecule_class.html#molecule_class.constructMolecules">[docs]</a><span class="k">def</span> <span class="nf">constructMolecules</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;From a LAMMPS input file construct a list of Molecule objects based on the molecules in the LAMMPS input file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The name of the LAMMPS input file that contains the molecules</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    molecules : Molecule List</span>
<span class="sd">        A list of Molecule objects with the data specified by the LAMMPS input file passed in.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading Data File:&quot;</span><span class="p">)</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="n">atm</span><span class="o">.</span><span class="n">loadAtoms</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">bonds</span> <span class="o">=</span> <span class="n">loadBonds</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">loadAngles</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">dihedrals</span> <span class="o">=</span> <span class="n">loadDihedrals</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Grouping Atoms by Molecule&quot;</span><span class="p">)</span>
    <span class="n">atom_dict</span> <span class="o">=</span> <span class="n">groupAtomsByMol</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Grouping Bonds by Molecule&quot;</span><span class="p">)</span>
    <span class="n">bond_dict</span> <span class="o">=</span> <span class="n">groupBondsByMol</span><span class="p">(</span><span class="n">atom_dict</span><span class="p">,</span><span class="n">bonds</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Grouping Angles by Molecule&quot;</span><span class="p">)</span>
    <span class="n">angle_dict</span> <span class="o">=</span> <span class="n">groupAnglesByMol</span><span class="p">(</span><span class="n">atom_dict</span><span class="p">,</span><span class="n">bond_dict</span><span class="p">,</span><span class="n">angles</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Grouping Dihedrals by ID&quot;</span><span class="p">)</span>
    <span class="n">dihedral_dict</span> <span class="o">=</span> <span class="n">groupDihedralsByMol</span><span class="p">(</span><span class="n">atom_dict</span><span class="p">,</span><span class="n">bond_dict</span><span class="p">,</span><span class="n">dihedrals</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Assembling Molecules&quot;</span><span class="p">)</span>
    <span class="n">molecules</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">molID</span> <span class="ow">in</span> <span class="n">atom_dict</span><span class="p">:</span>
        <span class="n">molecules</span><span class="p">[</span><span class="n">molID</span><span class="p">]</span><span class="o">=</span><span class="n">Molecule</span><span class="p">(</span><span class="n">molID</span><span class="p">,</span><span class="n">atom_dict</span><span class="p">[</span><span class="n">molID</span><span class="p">],</span><span class="n">bond_dict</span><span class="p">[</span><span class="n">molID</span><span class="p">],</span><span class="n">angle_dict</span><span class="p">[</span><span class="n">molID</span><span class="p">],</span><span class="n">dihedral_dict</span><span class="p">[</span><span class="n">molID</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">molecules</span></div>


<div class="viewcode-block" id="rot_quat"><a class="viewcode-back" href="../molecule_class.html#molecule_class.rot_quat">[docs]</a><span class="k">def</span> <span class="nf">rot_quat</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">rot_axis</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rotates a vector about a specified axis a specified angle theta using the quaternion method</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vector : float vector</span>
<span class="sd">        A vector of three elements that represents the X, Y, Z coordinates of the vector that one wishes to rotate</span>
<span class="sd">    theta : float</span>
<span class="sd">        The angle in radians by which the vector rotates.</span>
<span class="sd">    rot_axis : float vector</span>
<span class="sd">        A vector of three elements which represents the X,Y,Z elements of the rotation axis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_vector : float vector</span>
<span class="sd">        A vector of three elements representing the X,Y,Z coordinates of the old vector after rotation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rot_axis</span><span class="p">)</span><span class="o">==</span><span class="mf">0.</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The rotation axis must have a non-zero magnitude in order for rotation about the axis to make sense.&quot;</span><span class="p">)</span>
    <span class="n">rot_axis</span> <span class="o">=</span> <span class="n">rot_axis</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rot_axis</span><span class="p">)</span>
    <span class="n">vector_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
    <span class="n">quat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rot_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rot_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rot_axis</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">quat_inverse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rot_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rot_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rot_axis</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

    <span class="n">vect_quat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span><span class="o">/</span><span class="n">vector_mag</span>
    <span class="n">new_vector</span> <span class="o">=</span> <span class="n">quat_mult</span><span class="p">(</span><span class="n">quat_mult</span><span class="p">(</span><span class="n">quat</span><span class="p">,</span><span class="n">vect_quat</span><span class="p">),</span><span class="n">quat_inverse</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">*</span><span class="n">vector_mag</span></div>

<span class="k">def</span> <span class="nf">quat_mult</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">):</span>
    <span class="n">w1</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span> <span class="o">=</span> <span class="n">q1</span>
    <span class="n">w2</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span> <span class="o">=</span> <span class="n">q2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">w2</span><span class="o">-</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="o">-</span><span class="n">y1</span><span class="o">*</span><span class="n">y2</span><span class="o">-</span><span class="n">z1</span><span class="o">*</span><span class="n">z2</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x1</span><span class="o">*</span><span class="n">w2</span> <span class="o">+</span> <span class="n">y1</span><span class="o">*</span><span class="n">z2</span> <span class="o">-</span> <span class="n">z1</span><span class="o">*</span><span class="n">y2</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">y2</span> <span class="o">+</span> <span class="n">y1</span><span class="o">*</span><span class="n">w2</span> <span class="o">+</span> <span class="n">z1</span><span class="o">*</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="n">z2</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">z2</span> <span class="o">+</span> <span class="n">z1</span><span class="o">*</span><span class="n">w2</span> <span class="o">+</span> <span class="n">x1</span><span class="o">*</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="o">*</span><span class="n">x2</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">def align_vector(vector,align):</span>
<span class="sd">    normed_vector = vector/np.linalg.norm(vector)   </span>
<span class="sd">    normed_align = align/np.linalg.norm(align)</span>
<span class="sd">    axis_rotation = np.cross(vector,align)</span>
<span class="sd">    angle = acos(np.dot(normed_vector,normed_align))</span>
<span class="sd">    #w = cos(angle/2.)</span>
<span class="sd">    #x,y,z = unit_axis_rotation*sin(angle/2.)</span>
<span class="sd">    #quaternion = np.array([w,x,y,z])</span>
<span class="sd">    rot_quat(vector,angle,axis_rotation) </span>
<span class="sd">&quot;&quot;&quot;</span>




















</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Steven Merz

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>