

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Move Class &mdash; NP Monolayer Monte Carlo 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Molecule Class" href="molecule_class.html" />
    <link rel="prev" title="Simulation Class" href="simulation_class.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> NP Monolayer Monte Carlo
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="inheritance.html">Plot of Module Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="coverage.html">Undocumented Python objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulation_class.html">Simulation Class</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Move Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="molecule_class.html">Molecule Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="atom_class.html">Atom Class</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NP Monolayer Monte Carlo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Move Class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/move_class.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-move_class">
<span id="move-class"></span><h1>Move Class<a class="headerlink" href="#module-move_class" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="move_class.CBMCRegrowth">
<em class="property">class </em><code class="descclassname">move_class.</code><code class="descname">CBMCRegrowth</code><span class="sig-paren">(</span><em>simulation</em>, <em>anchortype</em>, <em>numtrials=5</em>, <em>parallel=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#CBMCRegrowth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.CBMCRegrowth" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that encapsulates a Configurationally Biased Regrowth move as outline by Siepmann et al. that inherits from the Move class.
Here the dihedral force fields of the simulation are also passed in to ais in choosing trial positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dihedral_ffs</strong> (<em>list of type DihedralForceField</em>) – A list of DihedralForceField objects associated with the simulation</p></li>
<li><p><strong>lmp</strong> (<em>lammps object</em>) – The lammps instance associated with the simulation.  Passed in so that the move can evaluate energies of moves and thereby calculate probabilities of acceptance.</p></li>
<li><p><strong>molecules</strong> (<em>list of type Molecule</em>) – A list of molecules that are available to apply a MC move to.</p></li>
<li><p><strong>numtrials</strong> (<em>int</em>) – The number of trial placements used at each step of the regrowth move.  Default is 5 trials.</p></li>
<li><p><strong>anchortype</strong> (<em>int</em>) – The type number in the LAMMPS file used for the atom type used for the anchor atom in each molecule.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="move_class.CBMCRegrowth.evaluate_energies">
<code class="descname">evaluate_energies</code><span class="sig-paren">(</span><em>molecule</em>, <em>index</em>, <em>rotations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#CBMCRegrowth.evaluate_energies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.CBMCRegrowth.evaluate_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Evluates the pair energy of the system for each of the given dihedral rotations at the specified index.  For these enegies to be consistent with CBMC all atoms past the index should be turned off with turn_off_molecule_atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<a class="reference internal" href="molecule_class.html#molecule_class.Molecule" title="molecule_class.Molecule"><em>Molecule</em></a>) – The molecule on which the dihedral rotations will be carried out</p></li>
<li><p><strong>index</strong> (<em>int</em>) – The index of the atom that is in the last position of the dihedral to be rotated.</p></li>
<li><p><strong>rotations</strong> (<em>list of floats</em>) – A list of floats which represent the desired rotation from the current dihedral angle in Radians.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>energies</strong> – An array of the pair energy for each of the specified rotations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Numpy array of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="move_class.CBMCRegrowth.parallel_evaluate_energies">
<code class="descname">parallel_evaluate_energies</code><span class="sig-paren">(</span><em>molecule</em>, <em>index</em>, <em>rotations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#CBMCRegrowth.parallel_evaluate_energies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.CBMCRegrowth.parallel_evaluate_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the pair potential energy of numtrials number of rotations about a the dihedral at the given molecule index and returns the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<a class="reference internal" href="molecule_class.html#molecule_class.Molecule" title="molecule_class.Molecule"><em>Molecule</em></a>) – The molecule that is currently being regrown</p></li>
<li><p><strong>index</strong> (<em>int</em>) – The index of the monomer in the molecular chain that is being rotated.</p></li>
<li><p><strong>rotations</strong> (<em>float</em>) – The degree of rotation of the dihedral in radians needed to reach each sample point for evaluation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>energies</strong> – A list of the pair potential energy for each rotation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="move_class.CBMCRegrowth.select_dih_angles">
<code class="descname">select_dih_angles</code><span class="sig-paren">(</span><em>dih_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#CBMCRegrowth.select_dih_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.CBMCRegrowth.select_dih_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns numtrials number of dihedral angles with probability given by the PDF given by the boltzmann distribution determined by the temperature and the dihedral forcefield.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dih_type</strong> (<em>int</em>) – An integer which corresponds to the type of Dihedral one wishes to samples.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>trial_dih_angles</strong> – An array of floats which correspond to the selected dihedral angles in radians.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Numpy array of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="move_class.CBMCRegrowth.select_index">
<code class="descname">select_index</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#CBMCRegrowth.select_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.CBMCRegrowth.select_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects a random index of a molecule ranging from 3 to the final index.  The index selection starts at 3 as no dihedral rotation does not move any atoms with index less than 3.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<a class="reference internal" href="molecule_class.html#molecule_class.Molecule" title="molecule_class.Molecule"><em>Molecule</em></a>) – The Molecule objectone wishes to select a ranomd index from.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>index</strong> – A random index from 3 to length of molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="move_class.CBMCRegrowth.select_random_molecule">
<code class="descname">select_random_molecule</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#CBMCRegrowth.select_random_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.CBMCRegrowth.select_random_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects a random elegible molecule (one with an anchor atom set) from the molecules provided by the Simulation object that the CBMCRegrowth object was passed in at initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>Random Elegible Molecule</strong> – A randomly chosen molecule from the list of elegible ones.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="molecule_class.html#molecule_class.Molecule" title="molecule_class.Molecule">Molecule</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="move_class.CBMCRegrowth.set_anchor_atoms">
<code class="descname">set_anchor_atoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#CBMCRegrowth.set_anchor_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.CBMCRegrowth.set_anchor_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>For every molecule in the Move’s associated simulation the anchor atom is set to the anchortype associated with the CBMCRegrowth instance.
Any molecule that does not have an atom of type anchortype is skipped.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="move_class.CBMCSwap">
<em class="property">class </em><code class="descclassname">move_class.</code><code class="descname">CBMCSwap</code><span class="sig-paren">(</span><em>simulation</em>, <em>anchortype</em>, <em>type_lengths</em>, <em>starting_index=3</em>, <em>numtrials=5</em>, <em>parallel=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#CBMCSwap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.CBMCSwap" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="move_class.CBMCSwap.align_mol_to_positions">
<code class="descname">align_mol_to_positions</code><span class="sig-paren">(</span><em>mol</em>, <em>positions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#CBMCSwap.align_mol_to_positions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.CBMCSwap.align_mol_to_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>swap_atom1_positions = np.copy(np.array([mol1.getAtomByMolIndex(i).position for i in range(0,index+1)]))
swap_atom2_positions = np.copy(np.array([mol2.getAtomByMolIndex(i).position for i in range(0,index+1)]))
anchor_distance = np.copy(mol1.getAtomByMolIndex(0).position - mol2.getAtomByMolIndex(0).position)</p>
<dl class="simple">
<dt>for i in range(index+1):</dt><dd><p>move1 = swap_atom2_positions[i]-mol1.getAtomByMolIndex(i).position
move2 = swap_atom1_positions[i]-mol2.getAtomByMolIndex(i).position
mol1.move_atoms_by_index(move1,i)
mol2.move_atoms_by_index(move2,i)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="move_class.CBMCSwap.select_random_molecules">
<code class="descname">select_random_molecules</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#CBMCSwap.select_random_molecules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.CBMCSwap.select_random_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects a random elegible molecule (one with an anchor atom set) from the molecules provided by the Simulation object that the CBMCRegrowth object was passed in at initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>Random Elegible Molecule</strong> – A randomly chosen molecule from the list of elegible ones.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="molecule_class.html#molecule_class.Molecule" title="molecule_class.Molecule">Molecule</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="move_class.Move">
<em class="property">class </em><code class="descclassname">move_class.</code><code class="descname">Move</code><span class="sig-paren">(</span><em>simulation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#Move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.Move" title="Permalink to this definition">¶</a></dt>
<dd><p>A class used to encapsulate all MC moves that can be used by a simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lmp</strong> (<em>lammps object</em>) – The lammps instance associated with the simulation.  Passed in so that the move can evaluate energies of moves and thereby calculate probabilities of acceptance.</p></li>
<li><p><strong>molecules</strong> (<em>list of type Molecule</em>) – A list of molecules that are available to apply a MC move to.</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – The temperature of the simulation in Kelvin.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="move_class.RotationMove">
<em class="property">class </em><code class="descclassname">move_class.</code><code class="descname">RotationMove</code><span class="sig-paren">(</span><em>simulation</em>, <em>anchortype</em>, <em>max_angle</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#RotationMove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.RotationMove" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="move_class.SwapMove">
<em class="property">class </em><code class="descclassname">move_class.</code><code class="descname">SwapMove</code><span class="sig-paren">(</span><em>simulation</em>, <em>anchortype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#SwapMove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.SwapMove" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="move_class.TranslationMove">
<em class="property">class </em><code class="descclassname">move_class.</code><code class="descname">TranslationMove</code><span class="sig-paren">(</span><em>simulation</em>, <em>max_disp</em>, <em>stationary_types</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#TranslationMove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.TranslationMove" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="move_class.TranslationMove.select_random_molecule">
<code class="descname">select_random_molecule</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/move_class.html#TranslationMove.select_random_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#move_class.TranslationMove.select_random_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects a random elegible molecule (one with no atoms of the type specified by stationary_types) from the molecules provided by the Simulation object that the CBMCRegrowth object was passed in at initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>Random Elegible Molecule</strong> – A randomly chosen molecule from the list of elegible ones.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="molecule_class.html#molecule_class.Molecule" title="molecule_class.Molecule">Molecule</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="molecule_class.html" class="btn btn-neutral float-right" title="Molecule Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="simulation_class.html" class="btn btn-neutral float-left" title="Simulation Class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Steven Merz

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>